rule_id: MSCP RULE
title: The macOS system must be configured with the SSH daemon LoginGraceTime set
  to 30 or less.
discussion: SSH should be configured to log users out after a 15-minute interval of
  inactivity and to wait only 30 seconds before timing out logon attempts. Terminating
  an idle session within a short time period reduces the window of opportunity for
  unauthorized personnel to take control of a management session enabled on the console
  or console port that has been left unattended. In addition, quickly terminating
  an idle session or an incomplete logon attempt will also free up resources committed
  by the managed network element.
check: /usr/bin/grep ^LoginGraceTime /etc/ssh/sshd_config
result: '[''If the value is not set to "30" or less, this is a finding.'']'
fix: 'To ensure that "LoginGraceTime" is configured correctly, run the following command:


  /usr/bin/sudo /usr/bin/sed -i.bak ''s/.*LoginGraceTime.*/LoginGraceTime 30/'' /etc/ssh/sshd_config'
references:
  srg:
  - SRG-OS-000163-GPOS-00072
  disa_stig:
  - APPL-12-000053
  cci:
  - CCI-001133
macOS:
- '12'
tags:
- stig
severity: medium
