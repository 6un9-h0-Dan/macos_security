rule_id: MSCP RULE
title: The macOS system must authenticate peripherals before establishing a connection.
discussion: 'Without authenticating devices, unidentified or unknown devices may be
  introduced, thereby facilitating malicious activity.


  Peripherals include, but are not limited to, such devices as flash drives, external
  storage, and printers.'
check: /usr/bin/sudo /usr/bin/security authorizationdb read system.preferences | grep
  -A1 shared
result: '[''If what is returned does not include the following, this is a finding.'',
  ''\t<key>shared</key>'', ''\t<false/>'']'
fix: "To ensure that authentication is required to access all system level preference\
  \ panes use the following procedure:\n\nCopy the authorization database to a file\
  \ using the following command:\n/usr/bin/sudo /usr/bin/security authorizationdb\
  \ read system.preferences > ~/Desktop/authdb.txt\nedit the file to change:\n   \
  \ <key>shared</key>\n    <true/>\nTo read:\n    <key>shared</key>\n    <false/>\n\
  \nReload the authorization database with the following command:\n/usr/bin/sudo /usr/bin/security\
  \ authorizationdb write system.preferences < ~/Desktop/authdb.txt"
references:
  srg:
  - SRG-OS-000378-GPOS-00163
  disa_stig:
  - APPL-12-002069
  cci:
  - CCI-001958
macOS:
- '12'
tags:
- stig
severity: medium
