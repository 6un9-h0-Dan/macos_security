rule_id: MSCP RULE
title: The macOS system must provide an immediate warning to the System Administrator
  (SA) and Information System Security Officer (ISSO) (at a minimum) when allocated
  audit record storage volume reaches 75 percent of repository maximum audit record
  storage capacity.
discussion: 'The audit service must be configured to require a minimum percentage
  of free disk space in order to run. This ensures that audit will notify the administrator
  that action is required to free up more disk space for audit logs.


  When "minfree" is set to 25 percent, security personnel are notified immediately
  when the storage volume is 75 percent full and are able to plan for audit record
  storage capacity expansion.'
check: /usr/bin/sudo /usr/bin/grep ^minfree /etc/security/audit_control
result: '[''If this returns no results, or does not contain "25", this is a finding.'']'
fix: 'Edit the "/etc/security/audit_control" file and change the value for "minfree"
  to "25" using the following command:


  /usr/bin/sudo /usr/bin/sed -i.bak ''s/.*minfree.*/minfree:25/'' /etc/security/audit_control;
  /usr/bin/sudo /usr/sbin/audit -s


  A text editor may also be used to implement the required updates to the "/etc/security/audit_control
  file".'
references:
  srg:
  - SRG-OS-000343-GPOS-00134
  disa_stig:
  - APPL-12-001030
  cci:
  - CCI-001855
macOS:
- '12'
tags:
- stig
severity: medium
