rule_id: MSCP RULE
title: The macOS system must disable the SSHD service.
discussion: "Without confidentiality and integrity protection mechanisms, unauthorized\
  \ individuals may gain access to sensitive information via a remote access session.\n\
  \nRemote access is access to DoD non-public information systems by an authorized\
  \ user (or an information system) communicating through an external, non-organization-controlled\
  \ network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\
  \nEncryption provides a means to secure the remote connection to prevent unauthorized\
  \ access to the data traversing the remote access connection (e.g., Remote Desktop\
  \ Protocol [RDP]), thereby providing a degree of confidentiality. The encryption\
  \ strength of a mechanism is selected based on the security categorization of the\
  \ information.\n\nPrivileged access contains control and configuration information\
  \ and is particularly sensitive, so additional protections are necessary. This is\
  \ maintained by using cryptographic mechanisms, such as a hash function or digital\
  \ signature, to protect integrity. \n\nNonlocal maintenance and diagnostic activities\
  \ are those activities conducted by individuals communicating through a network,\
  \ either an external network (e.g., the Internet) or an internal network.   \n\n\
  Use of weak or untested encryption algorithms undermines the purposes of using encryption\
  \ to protect data. The operating system must implement cryptographic modules adhering\
  \ to the higher standards approved by the federal government since this provides\
  \ assurance they have been tested and validated.\n\nThe implementation of OpenSSH\
  \ that is included with macOS does not utilize a FIPS 140-2 validated cryptographic\
  \ module.\n\n"
check: /bin/launchctl print-disabled system | grep sshd
result: '[''If the results do not show "com.openssh.sshd => true", this is a finding.'']'
fix: 'Disable the "SSHD" service by using the following command:


  /usr/bin/sudo /bin/launchctl disable system/com.openssh.sshd


  The system may need to be restarted for the update to take effect.'
references:
  srg:
  - SRG-OS-000250-GPOS-00093
  - SRG-OS-000033-GPOS-00014
  - SRG-OS-000319-GPOS-00164
  - SRG-OS-000393-GPOS-00173
  - SRG-OS-000394-GPOS-00174
  - SRG-OS-000112-GPOS-00057
  - SRG-OS-000113-GPOS-00058
  - SRG-OS-000423-GPOS-00187
  - SRG-OS-000424-GPOS-00188
  - SRG-OS-000425-GPOS-00189
  - SRG-OS-000426-GPOS-00190
  disa_stig:
  - APPL-12-000011
  cci:
  - CCI-000068
  - CCI-001453
  - CCI-001941
  - CCI-001942
  - CCI-001967
  - CCI-002418
  - CCI-002420
  - CCI-002421
  - CCI-002422
  - CCI-002890
  - CCI-003123
macOS:
- '12'
tags:
- stig
severity: medium
