rule_id: MSCP RULE
title: The macOS system must implement approved ciphers to protect the confidentiality
  of SSH connections.
discussion: 'Unapproved mechanisms for authentication to the cryptographic module
  are not verified, and therefore cannot be relied upon to provide confidentiality
  or integrity, resulting in the compromise of DoD data.


  Operating systems using encryption are required to use FIPS-compliant mechanisms
  for authenticating to cryptographic modules.


  The implementation of OpenSSH that is included with macOS does not use a FIPS 140-2
  validated cryptographic module. While the listed ciphers are FIPS 140-2 approved
  algorithms, the module implementing them has not been validated.


  By specifying a cipher list with the order of ciphers being in a "strongest to weakest"
  orientation, the system will automatically attempt to use the strongest cipher for
  securing SSH connections.


  '
check: ''
result: '['''', ''Ciphers aes256-ctr,aes192-ctr,aes128-ctr'', '''', ''If any ciphers
  other than "aes256-ctr", "aes192-ctr", or "aes128-ctr" are listed, the order differs
  from the example above, or the "Ciphers" keyword is missing, this is a finding.'']'
fix: 'Configure SSH to use secure cryptographic algorithms.


  To ensure that "Ciphers" set correctly, run the following command:


  /usr/bin/sudo /usr/bin/grep -q ''^Ciphers'' /etc/ssh/sshd_config && /usr/bin/sudo
  /usr/bin/sed -i.bak ''s/^Ciphers.*/Ciphers aes256-ctr,aes192-ctr,aes128-ctr/'' /etc/ssh/sshd_config
  || /usr/bin/sudo /usr/bin/sed -i.bak ''/.*Ciphers and keying.*/a\''$''\nCiphers
  aes256-ctr,aes192-ctr,aes128-ctr''$''\n'' /etc/ssh/sshd_config


  The SSH service must be restarted for changes to take effect.'
references:
  srg:
  - SRG-OS-000033-GPOS-00014
  - SRG-OS-000120-GPOS-00061
  - SRG-OS-000125-GPOS-00065
  - SRG-OS-000250-GPOS-00093
  - SRG-OS-000393-GPOS-00173
  - SRG-OS-000394-GPOS-00174
  disa_stig:
  - APPL-12-000054
  cci:
  - CCI-000803
  - CCI-000068
  - CCI-003123
  - CCI-002890
macOS:
- '12'
tags:
- stig
severity: medium
