rule_id: MSCP RULE
title: The macOS system must provide an immediate real-time alert to the System Administrator
  (SA) and Information System Security Officer (ISSO), at a minimum, of all audit
  failure events requiring real-time alerts.
discussion: The audit service should be configured to immediately print messages to
  the console or email administrator users when an auditing failure occurs. It is
  critical for the appropriate personnel to be aware if a system is at risk of failing
  to process audit logs as required. Without a real-time alert, security personnel
  may be unaware of an impending failure of the audit capability and system operation
  may be adversely affected.
check: /usr/bin/sudo /usr/bin/grep logger /etc/security/audit_warn
result: '[''If the argument "-s" is missing, or if "audit_warn" has not been otherwise
  modified to print errors to the console or send email alerts to the SA and ISSO,
  this is a finding.'']'
fix: 'To make "auditd" log errors to standard error as well as "syslogd", run the
  following command:


  /usr/bin/sudo /usr/bin/sed -i.bak ''s/logger -p/logger -s -p/'' /etc/security/audit_warn;
  /usr/bin/sudo /usr/sbin/audit -s'
references:
  srg:
  - SRG-OS-000344-GPOS-00135
  disa_stig:
  - APPL-12-001031
  cci:
  - CCI-001858
macOS:
- '12'
tags:
- stig
severity: medium
