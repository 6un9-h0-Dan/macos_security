rule_id: MSCP RULE
title: The macOS system must, for networked systems, compare internal information
  system clocks at least every 24 hours with a server that is synchronized to one
  of the redundant United States Naval Observatory (USNO) time servers or a time server
  designated for the appropriate DoD network (NIPRNet/SIPRNet) and/or the Global Positioning
  System (GPS).
discussion: "Inaccurate time stamps make it more difficult to correlate events and\
  \ can lead to an inaccurate analysis. Determining the correct time a particular\
  \ event occurred on a system is critical when conducting forensic analysis and investigating\
  \ system events. Sources outside of the configured acceptable allowance (drift)\
  \ may be inaccurate.\n\nSynchronizing internal information system clocks provides\
  \ uniformity of time stamps for information systems with multiple system clocks\
  \ and systems connected over a network. \n\nOrganizations should consider endpoints\
  \ that may not have regular access to the authoritative time server (e.g., mobile,\
  \ teleworking, and tactical endpoints).\n\n"
check: sudo systemsetup -getusingnetworktime
result: '[''If the following in not returned, this is a finding:'', ''Network Time:
  On'', '''', ''To verify that an authorized Time Server is configured, run the following
  command:'', '' sudo systemsetup -getnetworktimeserver'', '''', ''Only approved time
  servers should be configured for use.'', '''', ''If no server is configured, or
  if an unapproved time server is in use, this is a finding.'']'
fix: 'To enable the TIMED service, run the following command:


  /usr/bin/sudo systemsetup -setusingnetworktime on


  To configure a time server, use the following command:


  /usr/bin/sudo systemsetup -setnetworktimeserver "server"'
references:
  srg:
  - SRG-OS-000355-GPOS-00143
  - SRG-OS-000356-GPOS-00144
  disa_stig:
  - APPL-12-000014
  cci:
  - CCI-002046
  - CCI-001891
macOS:
- '12'
tags:
- stig
severity: medium
