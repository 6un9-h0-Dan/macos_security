rule_id: MSCP RULE
title: The macOS system must be configured with the SSH daemon ClientAliveCountMax
  option set to 0.
discussion: SSH should be configured with an Active Client Alive Maximum Count of
  0. Terminating an idle session within a short time period reduces the window of
  opportunity for unauthorized personnel to take control of a management session enabled
  on the console or console port that has been left unattended. In addition, quickly
  terminating an idle session or an incomplete logon attempt will also free up resources
  committed by the managed network element.
check: /usr/bin/grep ^ClientAliveCountMax /etc/ssh/sshd_config
result: '[''If the setting is not "ClientAliveCountMax 0", this is a finding.'']'
fix: 'To ensure that the SSH idle timeout occurs precisely when the "ClientAliveCountMax"
  is set, run the following command:


  /usr/bin/sudo /usr/bin/sed -i.bak ''s/.*ClientAliveCountMax.*/ClientAliveCountMax
  0/'' /etc/ssh/sshd_config'
references:
  srg:
  - SRG-OS-000163-GPOS-00072
  disa_stig:
  - APPL-12-000052
  cci:
  - CCI-001133
macOS:
- '12'
tags:
- stig
severity: medium
